{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/app-routing.module.ts","webpack:///src/app/app.module.ts","webpack:///src/app/components/app.component.ts","webpack:///src/app/components/app.component.html","webpack:///src/app/components/chat/chat.component.ts","webpack:///src/app/components/chat/chat.component.html","webpack:///src/app/components/comment/comment.component.ts","webpack:///src/app/components/comment/comment.component.html","webpack:///src/app/components/empty/empty.component.ts","webpack:///src/app/components/empty/empty.component.html","webpack:///src/app/components/login/login.component.ts","webpack:///src/app/components/login/login.component.html","webpack:///src/app/components/movie-player/movie-player.component.ts","webpack:///src/app/components/movie-player/movie-player.component.html","webpack:///src/app/components/movie-room/movie-room.component.ts","webpack:///src/app/components/movie-room/movie-room.component.html","webpack:///src/app/components/movielist/movielist.component.ts","webpack:///src/app/components/movielist/movielist.component.html","webpack:///src/app/entities/chatMessage.ts","webpack:///src/app/entities/messageType.ts","webpack:///src/app/entities/messageWrapper.ts","webpack:///src/app/entities/movieComment.ts","webpack:///src/app/entities/requests/chatMessagesRequest.ts","webpack:///src/app/entities/requests/movieCommentsRequest.ts","webpack:///src/app/entities/requests/movieListRequest.ts","webpack:///src/app/entities/requests/movieRoomPauseRequest.ts","webpack:///src/app/entities/requests/movieRoomPlayRequest.ts","webpack:///src/app/entities/requests/movieRoomRequest.ts","webpack:///src/app/entities/requests/movieRoomSeekRequest.ts","webpack:///src/app/entities/requests/movieRoomWithIdRequest.ts","webpack:///src/app/entities/requests/movieRoomsRequest.ts","webpack:///src/app/entities/requests/saveUserRequest.ts","webpack:///src/app/entities/requests/sendChatMessageRequest.ts","webpack:///src/app/entities/requests/sendMovieCommentRequest.ts","webpack:///src/app/guards/auth.guard.ts","webpack:///src/app/services/appConfig.service.ts","webpack:///src/app/services/websocket.service.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","routes","path","component","canActivate","children","pathMatch","AppRoutingModule","forRoot","imports","config","PROVIDER_ID","provider","provideConfig","AppModule","provide","useFactory","declarations","providers","bootstrap","AppComponent","authService","webSocketService","title","start","stop","signOut","selector","templateUrl","styleUrls","ChatComponent","chatMessages","changes","roomId","user","sendChatMessagesRequest","createChatMessagesReponsesSubscription","createChatMessageUpdatesSubscription","value","chatMessage","Date","push","sendChatMessageRequest","RoomId","self","chatMessagesResponseObserver","next","messages","length","setChatMessages","error","err","console","complete","log","subscribeToChatMessagesReponses","chatMessagesUpdateObserver","message","addChatMessage","subscribeToChatMessageUpdates","sendMessage","CommentComponent","comments","currentComment","movieCurrentTime","createCommentsReponsesSubscription","createCommentUpdatesSubscription","room","video","sendMovieCommentsRequest","Movie","Id","ontimeupdate","setTimeout","currentTime","comment","sendMovieCommentRequest","MovieId","undefined","show","subscribe","time","find","x","Shown","CurrentTime","User","firstName","Comment","commentsResponseObserver","setComments","subscribeToMovieCommentsReponses","commentsUpdateObserver","addComment","subscribeToMovieCommentUpdates","EmptyComponent","LoginComponent","MoviePlayerComponent","changeDetector","seekedByWS","src","Title","autoplay","preload","loop","fullscreen","download","quality","keyboard","muted","overlay","showFrameByFrame","createMovieRoomPauseUpdatesSubscription","createMovieRoomPlayUpdatesSubscription","createMovieRoomSeekUpdatesSubscription","detectChanges","onpause","sendPauseRequest","onplay","sendPlayRequest","onseeked","sendSeekRequest","pause","play","movieRoomResponsesObserver","TimeWatched","subscribeToMovieRoomPauseUpdates","movieRoomUpdatesObserver","subscribeToMovieRoomPlayUpdates","seek","subscribeToMovieRoomSeekUpdates","matVideo","videoComp","getVideoTag","MovieRoomComponent","route","params","authState","sendMovieRoomWithIdRequest","createMovieRoomResponsesSubscription","createMovieRoomUpdatesSubscription","debug","processMovieRoom","subscribeToMovieRoomResponses","subscribeToMovieRoomUpdates","MovielistComponent","router","movies","movieRooms","createMovieListResponsesSubscription","createMovieListUpdatesSubscription","createMovieRoomsResponsesSubscription","createMovieRoomsUpdatesSubscription","sendMovieListRequest","sendMovieRoomsRequest","movie","sendMovieRoomRequest","movieList","navigate","rooms","movieListResponsesObserver","processMovies","subscribeToMovieListResponses","movieListUpdatesObserver","subscribeToMovieListUpdates","movieRoomsResponsesObserver","processMovieRooms","subscribeToMovieRoomsResponses","movieRoomsUpdatesObserver","subscribeToMovieRoomsUpdates","ChatMessage","voiceMessage","datetime","Message","VoiceMessage","DateTime","MovieCurrentTime","MessageType","MessageWrapper","messageType","payload","type","JSON","stringify","MovieComment","movieId","ChatMessagesRequest","userId","MovieCommentsRequest","MovieListRequest","MovieRoomPauseRequest","MovieRoomPlayRequest","MovieRoomRequest","MovieRoomSeekRequest","MovieRoomWithIdRequest","MovieRoomsRequest","SaveUserRequest","SendChatMessageRequest","SendMovieCommentRequest","movieComment","AuthGuard","cookieService","loggedIn","sendSaveUserRequest","saveToCookie","authToken","idToken","state","existentCookie","get","signInWithGoogle","name","set","signIn","ux_mode","navigateByUrl","skipLocationChange","providedIn","AppConfigService","WebSocketsService","appConfigService","movieListResponseSubject","movieListUpdateSubject","movieRoomsResponseSubject","movieRoomsUpdateSubject","movieRoomResponseSubject","movieRoomUpdateSubject","movieRoomPauseUpdateSubject","movieRoomPlayUpdateSubject","movieRoomSeekUpdateSubject","chatMessagesReponseSubject","chatMessageUpdateSubject","commentsReponseSubject","commentUpdateSubject","connect","webSocketsServerUrl","webSocket","close","observer","url","WebSocket","onopen","messageEvent","info","onmessage","jsonReceived","data","handleMessage","onerror","onclose","closeEvent","request","SAVE_USER_REQUEST","MOVIE_LIST_REQUEST","MOVIE_ROOMS_REQUEST","MOVIE_ROOM_REQUEST","MOVIE_ROOM_WITH_ID_REQUEST","MOVIE_ROOM_PAUSE_REQUEST","MOVIE_ROOM_PLAY_REQUEST","MOVIE_ROOM_SEEK_REQUEST","CHAT_MESSAGES_REQUEST","SEND_CHAT_MESSAGE_REQUEST","MOVIE_COMMENTS_REQUEST","SEND_MOVIE_COMMENT_REQUEST","socket","reject","maxNumberOfAttempts","intervalTime","currentAttempt","interval","setInterval","clearInterval","readyState","OPEN","waitForOpenConnection","send","messageRecieved","messageWrapper","validateAndGetMessage","MOVIE_LIST_RESPONSE","parse","MOVIE_ROOMS_RESPONSE","MOVIE_ROOMS_UPDATE","roomsUpdated","MOVIE_ROOM_RESPONSE","MOVIE_ROOM_UPDATE","roomUpdated","MOVIE_ROOM_PLAY_UPDATE","roomActionPlay","UserId","Room","MOVIE_ROOM_PAUSE_UPDATE","roomActionPause","MOVIE_ROOM_SEEK_UPDATE","roomActionSeek","CHAT_MESSAGES_RESPONSE","CHAT_MESSAGE_UPDATE","MOVIE_COMMENTS_RESPONSE","MOVIE_COMMENT_UPDATE","messageReceived","hasOwnProperty","environment","production","bootstrapModule"],"mappings":"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","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { MovielistComponent } from './components/movielist/movielist.component';\nimport { AuthGuard } from './guards/auth.guard';\nimport { EmptyComponent } from './components/empty/empty.component';\nimport { MovieRoomComponent } from './components/movie-room/movie-room.component';\n\n\nconst routes: Routes = [\n  {\n    path: \"\",\n    component: EmptyComponent,\n    canActivate: [AuthGuard]\n  },\n  {\n    path: \"movies\",\n    children:[\n      {\n        path :\":room-id\",\n        component: MovieRoomComponent,\n        pathMatch:\"full\",\n        canActivate: [AuthGuard]\n      }\n    ]\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import { LoginComponent } from './components/login/login.component';\nimport { MovielistComponent } from './components/movielist/movielist.component';\nimport { MovieRoomComponent } from './components/movie-room/movie-room.component';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './components/app.component';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { SocialLoginModule, AuthServiceConfig, GoogleLoginProvider } from 'angularx-social-login';\nimport { EmptyComponent } from './components/empty/empty.component';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\nimport { MatVideoModule } from 'mat-video';\nimport { FormsModule } from '@angular/forms';\nimport { ChatComponent } from './components/chat/chat.component';\nimport { CommentComponent } from './components/comment/comment.component';\nimport { MoviePlayerComponent } from './components/movie-player/movie-player.component';\n\nconst config = new AuthServiceConfig([\n  {\n    id: GoogleLoginProvider.PROVIDER_ID,\n    provider: new GoogleLoginProvider(\"989131655048-3aj5o2omgm1fht1itf1v4j8r6lutnoss.apps.googleusercontent.com\")\n  }\n]);\nexport function provideConfig() {\n  return config;\n}\n@NgModule({\n  declarations: [\n    AppComponent,\n    LoginComponent,\n    MovielistComponent,\n    MovieRoomComponent,\n    EmptyComponent,\n    ChatComponent,\n    CommentComponent,\n    MoviePlayerComponent\n  ],\n  imports: [\n    BrowserModule,\n    AppRoutingModule,\n    FormsModule,\n    ReactiveFormsModule,\n    SocialLoginModule,\n    BrowserAnimationsModule,\n    MatVideoModule\n  ],\n  providers: [\n    {\n      provide: AuthServiceConfig,\n      useFactory: provideConfig\n    }\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { AuthService, SocialUser } from 'angularx-social-login';\nimport { WebSocketsService } from '../services/websocket.service';\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent implements OnInit, OnDestroy {\n  title = 'videostreamer';\n  signinForm: FormGroup;\n  user: SocialUser;\n  loggedIn: boolean;\n\n  constructor(private authService: AuthService, private webSocketService: WebSocketsService) {\n  }\n\n  ngOnInit() {\n    this.webSocketService.start();\n  }\n\n  ngOnDestroy(): void {\n    this.webSocketService.stop();\n  }\n\n  // signInWithGoogle(): void {\n  //   this.authService.signIn(GoogleLoginProvider.PROVIDER_ID);\n  // }\n  signOut(): void {\n    this.authService.signOut();\n  }\n}","\n\n<!-- <script src=\"https://apis.google.com/js/platform.js\" async defer></script>\n<meta name=\"google-signin-client_id\" content=\"989131655048-3aj5o2omgm1fht1itf1v4j8r6lutnoss.apps.googleusercontent.com\">\n<div class=\"g-signin2\" data-onsuccess=\"onSignIn\"></div> -->\n\n\n<!-- <html lang=\"en\"> -->\n\n<!-- <head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n  <title>Document</title>\n</head> -->\n<!-- \n<body class=\"bg-light\">\n  <div class=\"container\">\n    <div class=\"row py-5 justify-content-center\">\n      <div class=\"col-md-8\">\n        <h1 class=\"text-center py-4\">Sign In in Angular 8</h1>\n        <div *ngIf=\"loggedIn===false\">\n          <form [formGroup]=\"signinForm\">\n            <div class=\"form-group\">\n              <label for=\"email\">Email</label>\n              <input type=\"text\" class=\"form-control\" id=\"email\" formControlName=\"email\">\n            </div>\n\n            <div class=\"form-group\">\n              <label for=\"password\">Password</label>\n              <input type=\"password\" class=\"form-control\" id=\"password\" formControlName=\"password\">\n            </div>\n          </form>\n          <div>\n            <p>Or</p>\n          </div>\n          <div>\n            <button type=\"button\" (click)=\"signInWithGoogle()\" class=\"btn btn-primary\">Sign In With Google</button>\n          </div>\n        </div>\n        <div *ngIf=\"loggedIn===true\">\n          <div class=\"form-group\">\n            <label for=\"firstname\">First Name</label>\n            <input type=\"text\" class=\"form-control\" id=\"firstname\" [value]=\"user.firstName\" readonly>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"lastname\">Last Name</label>\n            <input type=\"text\" class=\"form-control\" id=\"idToken\" [value]=\"user.idToken\" readonly>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"email2\">Email</label>\n            <input type=\"text\" class=\"form-control\" id=\"authToken\" [value]=\"user.authToken\" readonly>\n          </div>\n\n          <button type=\"button\" (click)=\"signOut()\" class=\"btn btn-primary\">Sign Out</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</body> -->\n\n<!-- </html> -->\n<router-outlet></router-outlet>","import { Component, OnInit, Input, OnChanges } from '@angular/core';\nimport { ChatMessage } from 'src/app/entities/chatMessage';\nimport { SocialUser } from 'angularx-social-login';\nimport { WebSocketsService } from 'src/app/services/websocket.service';\nimport { Observer } from 'rxjs';\n\n@Component({\n  selector: 'chat',\n  templateUrl: './chat.component.html',\n  styleUrls: ['./chat.component.scss']\n})\nexport class ChatComponent implements OnInit, OnChanges {\n\n  @Input() roomId: string;\n  @Input() user: SocialUser;\n\n  chatMessages: ChatMessage[] = [];\n\n  constructor(private webSocketService: WebSocketsService) {\n  }\n\n  ngOnChanges(changes: import(\"@angular/core\").SimpleChanges): void {\n    if (!this.roomId || !this.user) {\n      return;\n    }\n\n    this.webSocketService.sendChatMessagesRequest(this.roomId);\n  }\n\n  ngOnInit(): void {\n    this.createChatMessagesReponsesSubscription();\n    this.createChatMessageUpdatesSubscription();\n  }\n\n  sendMessage(value: string) {\n    if (!value || value === \"\") {\n      return;\n    }\n\n    let chatMessage: ChatMessage = new ChatMessage(\n      this.roomId,\n      this.user,\n      value,\n      \"voice msg cica\",\n      new Date(),\n      //this.video.getVideoTag().currentTime,\n      1\n    );\n\n    this.chatMessages.push(chatMessage);\n\n    this.webSocketService.sendChatMessageRequest(this.roomId, chatMessage);\n  }\n\n  private setChatMessages(roomId: string, chatMessages: ChatMessage[]) {\n    if (roomId !== this.roomId) {\n      return;\n    }\n\n    if (!chatMessages) {\n      return;\n    }\n\n    this.chatMessages = chatMessages;\n  }\n\n  private addChatMessage(chatMessage: ChatMessage) {\n    if (!chatMessage) {\n      return;\n    }\n\n    if (chatMessage.RoomId !== this.roomId) {\n      return;\n    }\n\n    this.chatMessages.push(chatMessage);\n  }\n\n  private createChatMessagesReponsesSubscription() {\n    let self = this;\n    const chatMessagesResponseObserver: Observer<ChatMessage[]> = {\n      next: function (messages: ChatMessage[]): void {\n        if (!messages || messages.length === 0) {\n          return;\n        }\n\n        self.setChatMessages(messages[0].RoomId, messages);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more chat messages responses');\n      }\n    };\n\n    this.webSocketService.subscribeToChatMessagesReponses(chatMessagesResponseObserver);\n  }\n\n  private createChatMessageUpdatesSubscription() {\n    let self = this;\n    const chatMessagesUpdateObserver: Observer<ChatMessage> = {\n      next: function (message: ChatMessage): void {\n        if (!message) {\n          return;\n        }\n\n        self.addChatMessage(message);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more chat message updates');\n      }\n    };\n\n    this.webSocketService.subscribeToChatMessageUpdates(chatMessagesUpdateObserver);\n  }\n\n}\n","<div class=\"panel panel-primary\">\n    <div class=\"panel-heading\" style=\"padding:0;\">\n        <!-- <span class=\"glyphicon glyphicon-user\"></span> -->\n        <h6 class=\"panel-title\" style=\"display:inline;\">Chat</h6>\n        <!-- <div class=\"btn-group btn-group-xs pull-right\">\n        <button type=\"button\" class=\"btn btn-primary\"><span\n                class=\"glyphicon glyphicon-lock\"></span></button>\n        <button type=\"button\" class=\"btn btn-primary\"><span\n                class=\"glyphicon glyphicon-cog\"></span></button>\n        <button type=\"button\" class=\"btn btn-primary\"><span\n                class=\"glyphicon glyphicon-remove\"></span></button>\n    </div> -->\n        <div class=\"clearfix\"></div>\n    </div>\n    <div class=\"panel-body\" style=\"padding:0;\">\n        <div #msgContainer\n            style=\"max-height:70vh; max-width:100%;overflow-y:auto;overflow-x:hidden; padding: 0px;\">\n            <table class=\"table table-hover table-condensed\" *ngIf=\"chatMessages.length !== 0\">\n                <tr *ngFor=\"let message of chatMessages\" style=\"width:100%;\" class=\"row\">\n                    <td style=\"padding-right: 0px;\">\n                        <img [src]=\"message.User.photoUrl\" style=\"height: 20px;\" /></td>\n                    <td style=\"padding-right: 0px;\">\n                        <h4>{{message.User.firstName}}:</h4>\n                    </td>\n                    <td class=\"col col-xs-11\">\n                        <h4 class=\"word-wrap:break-word\" style=\"margin:0px;\">{{message.Message}}</h4>\n                    </td>\n                </tr>\n                <tr *ngIf=\"chatMessages.length === 0\">\n                    <td>\n                        <p>Nothin' here. <strong>Say something!</strong></p>\n                    </td>\n                </tr>\n            </table>\n        </div>\n    </div>\n    <div class=\"panel-footer\">\n        <form>\n            <div class=\"input-group input-group-sm\">\n                <input #msg type=\"text\" class=\"form-control\" placeholder=\"Send a message...\" />\n                <span class=\"input-group-btn\">\n                    <button class=\"btn btn-primary\" type=\"submit\"\n                        style=\"height: 31px; margin-left: 5px; padding-top: 2px;\"\n                        (click)=\"sendMessage(msg.value)\">Send</button>\n                </span>\n            </div>\n        </form>\n    </div>\n","import { Component, OnInit, Input, OnChanges } from '@angular/core';\nimport { MovieComment } from 'src/app/entities/movieComment';\nimport { WebSocketsService } from 'src/app/services/websocket.service';\nimport { SocialUser } from 'angularx-social-login';\nimport { MovieRoom } from 'src/app/entities/movieRoom';\nimport { Observer, Subject } from 'rxjs';\n\n@Component({\n  selector: 'comment',\n  templateUrl: './comment.component.html',\n  styleUrls: ['./comment.component.scss']\n})\nexport class CommentComponent implements OnInit, OnChanges {\n\n  @Input() room: MovieRoom;\n  @Input() video: HTMLVideoElement;\n  @Input() user: SocialUser;\n\n  comments: MovieComment[] = [];\n  currentComment: string = \"\";\n\n  movieCurrentTime: Subject<number> = new Subject<number>();\n\n  constructor(private webSocketService: WebSocketsService) { }\n\n  ngOnInit(): void {\n    this.createCommentsReponsesSubscription();\n    this.createCommentUpdatesSubscription();\n  }\n\n  ngOnChanges(changes: import(\"@angular/core\").SimpleChanges): void {\n    if (!this.room || !this.user || !this.video) {\n      return;\n    }\n\n    this.webSocketService.sendMovieCommentsRequest(this.room.Movie.Id);\n    this.video.ontimeupdate = () => {\n      setTimeout(() => { this.movieCurrentTime.next(this.video.currentTime); }, 1000)\n    }\n  }\n\n  sendComment(value: string) {\n    let comment: MovieComment = new MovieComment(\n      this.room.Movie.Id,\n      this.user,\n      value,\n      this.video.currentTime);\n\n    this.comments.push(comment);\n\n    this.webSocketService.sendMovieCommentRequest(this.room.Movie.Id, comment);\n  }\n\n  addComment(comment: MovieComment) {\n    if (comment == null) {\n      return;\n    }\n\n    if (comment.MovieId !== this.room.Movie.Id) {\n      return;\n    }\n\n    this.comments.push(comment);\n  }\n\n  setComments(comments: MovieComment[]) {\n    if (comments === null || comments === undefined || comments.length === 0) {\n      return;\n    }\n\n    if (comments[0].MovieId !== this.room.Movie.Id) {\n      return;\n    }\n\n    this.comments = comments;\n    this.show();\n  }\n\n  show() {\n    this.movieCurrentTime.subscribe(time => {\n\n      let comment = this.comments.find(x => x.Shown === undefined && x.CurrentTime - time < 2 && x.CurrentTime - time > -2);\n      if (comment) {\n        this.currentComment = `${comment.User.firstName}: ${comment.Comment}`;\n        comment.Shown = true;\n        setTimeout(() => { this.currentComment = \"\" }, 2000)\n      }\n    });\n  }\n\n  private createCommentsReponsesSubscription() {\n    let self = this;\n    const commentsResponseObserver: Observer<MovieComment[]> = {\n      next: function (messages: MovieComment[]): void {\n        if (!messages || messages.length === 0) {\n          return;\n        }\n\n        self.setComments(messages);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more chat messages responses');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieCommentsReponses(commentsResponseObserver);\n  }\n\n  private createCommentUpdatesSubscription() {\n    let self = this;\n    const commentsUpdateObserver: Observer<MovieComment> = {\n      next: function (message: MovieComment): void {\n        if (!message) {\n          return;\n        }\n\n        self.addComment(message);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more chat message updates');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieCommentUpdates(commentsUpdateObserver);\n  }\n}\n","<div *ngIf=\"video\">\n    <div class=\"row\">\n        <div class=\"col col-sm-2\">\n            <p>Send comment:</p>\n        </div>\n        <div class=\"col col-sm-1\">\n            <input #comm (keyup.enter)=\"sendComment(comm.value)\">\n        </div>\n    </div>\n\n    <p>Current comment: {{currentComment}}</p>\n</div>","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-empty',\n  templateUrl: './empty.component.html',\n  styleUrls: ['./empty.component.scss']\n})\nexport class EmptyComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n    \n  }\n\n}\n","<movie-list></movie-list>","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.scss']\n})\nexport class LoginComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n}\n","<p>login works!</p>\n","import { Component, OnInit, Input, OnChanges, ViewChild, ChangeDetectorRef } from '@angular/core';\nimport { WebSocketsService } from 'src/app/services/websocket.service';\nimport { MovieRoom } from 'src/app/entities/movieRoom';\nimport { MatVideoComponent } from 'mat-video/lib/video.component';\nimport { Observer } from 'rxjs';\nimport { SocialUser } from 'angularx-social-login';\n\n@Component({\n  selector: 'movie-player',\n  templateUrl: './movie-player.component.html',\n  styleUrls: ['./movie-player.component.scss']\n})\nexport class MoviePlayerComponent implements OnInit, OnChanges {\n  private videoComp: MatVideoComponent;\n  video: HTMLVideoElement;\n  @ViewChild('video') set matVideo(matVideo: MatVideoComponent) {\n    if (matVideo) { // initially setter gets called with undefined\n      this.videoComp = matVideo;\n\n      this.video = this.videoComp.getVideoTag();\n    }\n  }\n\n  @Input() room: MovieRoom;\n  @Input() user: SocialUser;\n\n  seekedByWS: boolean = false;\n\n  constructor(\n    private webSocketService: WebSocketsService,\n    private changeDetector: ChangeDetectorRef) { }\n\n  ngOnInit(): void {\n    this.createMovieRoomPauseUpdatesSubscription();\n    this.createMovieRoomPlayUpdatesSubscription();\n    this.createMovieRoomSeekUpdatesSubscription();\n  }\n\n  ngOnChanges() {\n    if (!this.room || !this.user) {\n      return;\n    }\n\n    this.title = this.room.Movie.Title;\n    this.changeDetector.detectChanges();\n\n    this.video.onpause = () => {\n      // check if it's on pause already-> don't make request\n      console.log(`on pause called, current time: ${this.video.currentTime}`);\n\n      // send ws request to pause video for all\n      this.webSocketService.sendPauseRequest(this.room.Id, this.video.currentTime);\n    }\n\n    this.video.onplay = () => {\n      console.log(`on play called, current time: ${this.video.currentTime}`);\n\n      // send ws reuqest to play the video\n      this.webSocketService.sendPlayRequest(this.room.Id, this.video.currentTime);\n    }\n\n    this.video.onseeked = () => {\n      console.log(`on seeked moved called, current time: ${this.video.currentTime}`);\n      if (!this.seekedByWS) {\n        // send ws request to update the time\n        this.webSocketService.sendSeekRequest(this.room.Id, this.video.currentTime);\n      }\n\n      this.seekedByWS = false;\n    }\n  }\n\n  private pause(roomId: string, currentTime: number) {\n    if (roomId !== this.room.Id) {\n      return;\n    }\n\n    this.changeDetector.detectChanges();\n    this.video.pause();\n\n    this.currentTime = currentTime;\n  }\n\n  private play(roomId: string, currentTime: number) {\n    if (roomId !== this.room.Id) {\n      return;\n    }\n\n    this.changeDetector.detectChanges();\n    this.video.play();\n\n    this.currentTime = currentTime;\n  }\n\n  private seek(roomId: string, currentTime: number) {\n    if (roomId !== this.room.Id) {\n      return;\n    }\n\n    this.changeDetector.detectChanges();\n    this.seekedByWS = true;\n\n    this.video.currentTime = currentTime;\n\n    this.currentTime = currentTime;\n  }\n\n  private createMovieRoomPauseUpdatesSubscription() {\n    let self = this;\n    const movieRoomResponsesObserver: Observer<MovieRoom> = {\n      next: function (room: MovieRoom): void {\n        self.pause(room.Id, room.TimeWatched);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more movies responses');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieRoomPauseUpdates(movieRoomResponsesObserver);\n  }\n\n  private createMovieRoomPlayUpdatesSubscription() {\n    let self = this;\n    const movieRoomUpdatesObserver: Observer<MovieRoom> = {\n      next: function (room: MovieRoom): void {\n        self.play(room.Id, room.TimeWatched);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more movies responses');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieRoomPlayUpdates(movieRoomUpdatesObserver);\n  }\n\n  private createMovieRoomSeekUpdatesSubscription() {\n    let self = this;\n    const movieRoomUpdatesObserver: Observer<MovieRoom> = {\n      next: function (room: MovieRoom): void {\n        self.seek(room.Id, room.TimeWatched);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more movies responses');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieRoomSeekUpdates(movieRoomUpdatesObserver);\n  }\n\n  ngclass: any;\n  src: string = \"http://static.videogular.com/assets/videos/videogular.mp4\";\n  title: string = this.room ? this.room.Movie.Title : \"Not loaded yet\";\n  autoplay: boolean = true;\n  preload: boolean = true;\n  loop: boolean = false;\n  fullscreen: boolean = false;\n  download: boolean = false;\n  quality: boolean = true;\n  keyboard: boolean = true;\n  spinner: any;\n  poster: any;\n  muted: boolean = true;\n  overlay: boolean = true;\n  showFrameByFrame: boolean = false;\n  currentTime: number = 1;\n  color: any;\n}\n","<!-- comments -->\n<comment [room]=\"room\" [user]=\"user\" [video]=\"video\"></comment>\n\n<mat-video #video [src]=\"src\" [title]=\"title\" [autoplay]=\"autoplay\" [preload]=\"preload\" [loop]=\"loop\"\n    [fullscreen]=\"fullscreen\" [download]=\"download\" [quality]=\"quality\" [keyboard]=\"keyboard\" [color]=\"color\"\n    [spinner]=\"spinner\" [poster]=\"poster\" [overlay]=\"overlay\" [(muted)]=\"muted\" [showFrameByFrame]=\"showFrameByFrame\"\n    [(time)]=\"currentTime\">\n</mat-video>","import { Component, OnInit, ViewChild, ChangeDetectorRef } from '@angular/core';\nimport { ActivatedRoute } from \"@angular/router\";\nimport { WebSocketsService } from 'src/app/services/websocket.service';\nimport { Observer, Observable, of, Subject } from 'rxjs';\nimport { MovieRoom } from 'src/app/entities/movieRoom';\nimport { AuthService, SocialUser } from 'angularx-social-login';\n\n@Component({\n  selector: 'app-movie-room',\n  templateUrl: './movie-room.component.html',\n  styleUrls: ['./movie-room.component.scss']\n})\nexport class MovieRoomComponent implements OnInit {\n  room: MovieRoom;\n  roomId: string;\n\n  user: SocialUser;\n\n  constructor(private route: ActivatedRoute,\n    private webSocketService: WebSocketsService,\n    private authService: AuthService) {\n\n    this.route.params.subscribe(params => {\n      console.log(params);\n\n      this.authService.authState.subscribe(user => {\n        if (user !== null && user !== undefined) {\n          this.user = user;\n\n          this.roomId = params[\"room-id\"];\n          console.log(this.roomId);\n\n          this.webSocketService.sendMovieRoomWithIdRequest(this.roomId);\n        }\n      })\n    });\n  }\n\n  ngOnInit(): void {\n    this.createMovieRoomResponsesSubscription();\n    this.createMovieRoomUpdatesSubscription();\n  }\n\n  private processMovieRoom(room: MovieRoom): Observable<MovieRoom> {\n    console.debug('Movie Room received through the observer:\\n%o', room);\n\n    this.room = room;\n\n    return of(room);\n  }\n\n  private createMovieRoomResponsesSubscription() {\n    let self = this;\n    const movieRoomResponsesObserver: Observer<MovieRoom> = {\n      next: function (room: MovieRoom): void {\n        self.processMovieRoom(room).subscribe(room => {\n          self.webSocketService.sendMovieCommentsRequest(room.Movie.Id);\n        });\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more movies responses');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieRoomResponses(movieRoomResponsesObserver);\n  }\n\n  private createMovieRoomUpdatesSubscription() {\n    let self = this;\n    const movieRoomUpdatesObserver: Observer<MovieRoom> = {\n      next: function (room: MovieRoom): void {\n        if (room.Id !== self.roomId) {\n          return;\n        }\n\n        self.processMovieRoom(room);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more movies responses');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieRoomUpdates(movieRoomUpdatesObserver);\n  }\n}\n","<div *ngIf=\"room!==undefined\" style=\"padding: 10px;\">\n    <div class=\"row\">\n        <div class=\"col col-lg-10\"></div>\n        <div style=\"display: inline-flex;\">\n            <img [src]=\"user.photoUrl\" style=\"height: 20px;\">\n        </div>\n        <div style=\"display: inline-flex; margin-left: 8px;\">\n            <p>{{user.name}}</p>\n        </div>\n    </div>\n\n    <div class=\"row\">\n        <div class=\"col col-sm-2\">\n            <p>Users in room:</p>\n        </div>\n        <div>\n            <ul>\n                <li *ngFor=\"let user of room.Users\">\n                    <p>{{user.name}}</p>\n                </li>\n            </ul>\n        </div>\n\n        <div class=\"row col-lg-12\" style=\"max-height: 60vh;\">\n\n            <!-- video  -->\n            <div class=\"col-lg-8\">\n                <movie-player [room]=\"room\" [user]=\"user\"></movie-player>\n            </div>\n\n            <!-- chat -->\n            <div class=\"col-lg-4 hidden-md hidden-sm hidden-xs\">\n                <chat [roomId]=\"roomId\" [user]=\"user\"></chat>\n            </div>\n        </div>\n    </div>","import { Component, OnInit } from '@angular/core';\nimport { WebSocketsService } from 'src/app/services/websocket.service';\nimport { Observer } from 'rxjs';\nimport { Movie } from 'src/app/entities/movie';\nimport { Router } from '@angular/router';\nimport { MovieRoom } from 'src/app/entities/movieRoom';\n\n@Component({\n  selector: 'movie-list',\n  templateUrl: './movielist.component.html',\n  styleUrls: ['./movielist.component.scss']\n})\nexport class MovielistComponent implements OnInit {\n\n  movies: Movie[] = [];\n  movieRooms: MovieRoom[] = [];\n  constructor(private webSocketService: WebSocketsService, private router: Router) { }\n\n  ngOnInit(): void {\n    this.createMovieListResponsesSubscription();\n    this.createMovieListUpdatesSubscription();\n\n    this.createMovieRoomsResponsesSubscription();\n    this.createMovieRoomsUpdatesSubscription();\n\n    this.createMovieRoomResponsesSubscription();\n    this.createMovieRoomUpdatesSubscription();\n\n    this.webSocketService.sendMovieListRequest();\n    this.webSocketService.sendMovieRoomsRequest();\n  }\n\n  goToMovie(movie: Movie) {\n    console.log(movie);\n\n    this.webSocketService.sendMovieRoomRequest(movie.Id);\n  }\n\n  private processMovies(movieList: Movie[]): void {\n    console.debug('Movies received through the observer:\\n%o', movieList);\n\n    this.movies = movieList;\n  }\n\n  private processMovieRoom(room: MovieRoom): void {\n    console.debug('Movie Room received through the observer:\\n%o', room);\n\n    this.router.navigate([`movies/${room.Id}`]);\n  }\n\n  private processMovieRooms(rooms: MovieRoom[]): void {\n    console.debug('Movie Rooms received through the observer:\\n%o', rooms);\n\n    this.movieRooms = rooms;\n  }\n\n  private createMovieListResponsesSubscription() {\n    let self = this;\n    const movieListResponsesObserver: Observer<Movie[]> = {\n      next: function (movies: Movie[]): void {\n        self.processMovies(movies);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more movies responses');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieListResponses(movieListResponsesObserver);\n  }\n\n  private createMovieListUpdatesSubscription() {\n    let self = this;\n    const movieListUpdatesObserver: Observer<Movie[]> = {\n      next: function (movies: Movie[]): void {\n        self.processMovies(movies);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more movies updates');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieListUpdates(movieListUpdatesObserver);\n  }\n\n  private createMovieRoomsResponsesSubscription() {\n    let self = this;\n    const movieRoomsResponsesObserver: Observer<MovieRoom[]> = {\n      next: function (movieRooms: MovieRoom[]): void {\n        self.processMovieRooms(movieRooms);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more movies responses');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieRoomsResponses(movieRoomsResponsesObserver);\n  }\n\n  private createMovieRoomsUpdatesSubscription() {\n    let self = this;\n    const movieRoomsUpdatesObserver: Observer<MovieRoom[]> = {\n      next: function (movieRooms: MovieRoom[]): void {\n        self.processMovieRooms(movieRooms);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more movies updates');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieRoomsUpdates(movieRoomsUpdatesObserver);\n  }\n\n  private createMovieRoomResponsesSubscription() {\n    let self = this;\n    const movieRoomResponsesObserver: Observer<MovieRoom> = {\n      next: function (room: MovieRoom): void {\n        self.processMovieRoom(room);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more movies responses');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieRoomResponses(movieRoomResponsesObserver);\n  }\n\n  private createMovieRoomUpdatesSubscription() {\n    let self = this;\n    const movieRoomUpdatesObserver: Observer<MovieRoom> = {\n      next: function (room: MovieRoom): void {\n        self.processMovieRoom(room);\n      },\n\n      error: function (err: any): void {\n        console.error('Error: %o', err);\n      },\n\n      complete: function (): void {\n        console.log('No more movies responses');\n      }\n    };\n\n    this.webSocketService.subscribeToMovieRoomUpdates(movieRoomUpdatesObserver);\n  }\n}\n","<div *ngIf=\"movies.length > 0\" class=\"bold\">\n    <h3>Movies</h3>\n    <p>Movies count:{{movies.length}}</p>\n    <div>\n        <ul>\n            <li *ngFor=\"let movie of movies\">\n                <button (click)=\"goToMovie(movie)\">{{movie.Title}}</button>\n            </li>\n        </ul>\n    </div>\n\n    <div>\n        <p>Movie rooms count: {{movieRooms.length}}\n        <ul>\n            <li *ngFor=\"let room of movieRooms\">\n                <button>{{room.Id}}</button>\n            </li>\n        </ul>\n    </div>\n</div>","import { SocialUser } from 'angularx-social-login';\r\n\r\nexport class ChatMessage {\r\n    Id: string;\r\n    RoomId: string;\r\n    User: SocialUser;\r\n\r\n    Message: string;\r\n    VoiceMessage: string;\r\n    DateTime: Date;\r\n    MovieCurrentTime: number; // seconds into the movie\r\n\r\n    constructor(roomId: string, user: SocialUser, message: string, voiceMessage: string, datetime: Date, movieCurrentTime: number) {\r\n        this.RoomId = roomId;\r\n        this.User = user;\r\n        this.Message = message;\r\n        this.VoiceMessage = voiceMessage;\r\n        this.DateTime = datetime;\r\n        this.MovieCurrentTime = movieCurrentTime;\r\n    }\r\n}\r\n","export enum MessageType {\r\n\r\n  SAVE_USER_REQUEST = 'SAVE_USER_REQUEST',\r\n  \r\n  MOVIE_LIST_REQUEST = 'MOVIE_LIST_REQUEST',\r\n  MOVIE_LIST_RESPONSE = 'MOVIE_LIST_RESPONSE',\r\n  MOVIE_LIST_UPDATE = 'MOVIE_LIST_UPDATE',\r\n\r\n  MOVIE_ROOMS_REQUEST = 'MOVIE_ROOMS_REQUEST',\r\n  MOVIE_ROOMS_RESPONSE = 'MOVIE_ROOMS_RESPONSE',\r\n  MOVIE_ROOMS_UPDATE = 'MOVIE_ROOMS_UPDATE',\r\n\r\n  MOVIE_ROOM_REQUEST = 'MOVIE_ROOM_REQUEST',\r\n  MOVIE_ROOM_WITH_ID_REQUEST = 'MOVIE_ROOM_WITH_ID_REQUEST',\r\n  MOVIE_ROOM_RESPONSE = 'MOVIE_ROOM_RESPONSE',\r\n  MOVIE_ROOM_UPDATE = 'MOVIE_ROOM_UPDATE',\r\n\r\n  MOVIE_STREAM_REQUEST = 'MOVIE_STREAM_REQUEST',\r\n  MOVIE_STREAM_RESPONSE = 'MOVIE_STREAM_RESPONSE',\r\n  MOVIE_STREAM_UPDATE = 'MOVIE_STREAM_UPDATE',\r\n  \r\n  MOVIE_CHAT_REQUEST = 'MOVIE_CHAT_REQUEST',\r\n  MOVIE_CHAT_RESPONSE = 'MOVIE_CHAT_RESPONSE',\r\n  MOVIE_CHAT_UPDATE = 'MOVIE_CHAT_UPDATE',\r\n\r\n  SEND_CHAT_MESSAGE_REQUEST = 'SEND_CHAT_MESSAGE_REQUEST',\r\n  CHAT_MESSAGES_REQUEST = 'CHAT_MESSAGES_REQUEST',\r\n  CHAT_MESSAGES_RESPONSE = 'CHAT_MESSAGES_RESPONSE',\r\n  CHAT_MESSAGE_UPDATE = 'CHAT_MESSAGE_UPDATE',\r\n\r\n  SEND_MOVIE_COMMENT_REQUEST = 'SEND_MOVIE_COMMENT_REQUEST',\r\n  MOVIE_COMMENTS_REQUEST = 'MOVIE_COMMENTS_REQUEST',\r\n  MOVIE_COMMENTS_RESPONSE = 'MOVIE_COMMENTS_RESPONSE',\r\n  MOVIE_COMMENT_UPDATE = 'MOVIE_COMMENT_UPDATE',\r\n\r\n  MOVIE_ROOM_PAUSE_REQUEST = 'MOVIE_ROOM_PAUSE_REQUEST',\r\n  MOVIE_ROOM_PAUSE_UPDATE = 'MOVIE_ROOM_PAUSE_UPDATE',\r\n  \r\n  MOVIE_ROOM_PLAY_REQUEST = 'MOVIE_ROOM_PLAY_REQUEST',\r\n  MOVIE_ROOM_PLAY_UPDATE = 'MOVIE_ROOM_PLAY_UPDATE',\r\n  \r\n  MOVIE_ROOM_SEEK_REQUEST = 'MOVIE_ROOM_SEEK_REQUEST',\r\n  MOVIE_ROOM_SEEK_UPDATE = 'MOVIE_ROOM_SEEK_UPDATE',\r\n\r\n  MOVIE_CLOSE_REQUEST = 'MOVIE_CLOSE_REQUEST',\r\n  MOVIE_CLOSE_RESPONSE = 'MOVIE_CLOSE_RESPONSE',\r\n\r\n  // hmm............... idk if personal is needed or doable in the current implementation\r\n  MOVIE_CLOSE_PERSONAL_REQUEST = 'MOVIE_CLOSE_PERSONAL_REQUEST',\r\n  MOVIE_CLOSE_PERSONAL_RESPONSE = 'MOVIE_CLOSE_PERSONAL_RESPONSE'\r\n}\r\n","import { MessageType } from './messageType';\r\nexport class MessageWrapper {\r\n\r\n  readonly type: string;\r\n  readonly payload: string;\r\n\r\n  constructor(messageType: MessageType, payload: Object) {\r\n    this.type = messageType;\r\n    this.payload = JSON.stringify(payload);\r\n  }\r\n}\r\n","import { SocialUser } from 'angularx-social-login';\r\n\r\nexport class MovieComment {\r\n\r\n  Id: string;\r\n  MovieId: string;\r\n  User: SocialUser;\r\n\r\n  Comment: string;\r\n  CurrentTime: number;\r\n  Shown: boolean;\r\n\r\n  constructor(movieId: string, user: SocialUser, comment: string, currentTime: number) {\r\n    this.MovieId = movieId;\r\n    this.User = user;\r\n    this.Comment = comment;\r\n    this.CurrentTime = currentTime;\r\n  }\r\n}\r\n","export class ChatMessagesRequest {\r\n\r\n  public roomId: string;\r\n  public userId: string;\r\n\r\n  constructor(roomId: string, userId: string) {\r\n    this.roomId = roomId;\r\n    this.userId = userId;\r\n  }\r\n}\r\n","export class MovieCommentsRequest {\r\n\r\n  public movieId: string;\r\n\r\n  constructor(movieId: string) {\r\n    this.movieId = movieId;\r\n  }\r\n}\r\n","export class MovieListRequest {\r\n \r\n  constructor () {\r\n  }\r\n}\r\n","export class MovieRoomPauseRequest {\r\n\r\n  public roomId: string;\r\n  public userId: string;\r\n  public currentTime: number;\r\n\r\n  constructor(roomId: string, userId: string, currentTime: number) {\r\n    this.roomId = roomId;\r\n    this.userId = userId;\r\n    this.currentTime = currentTime;\r\n  }\r\n}\r\n","export class MovieRoomPlayRequest {\r\n\r\n  public roomId: string;\r\n  public userId: string;\r\n  public currentTime: number;\r\n\r\n  constructor(roomId: string, userId: string, currentTime: number) {\r\n    this.roomId = roomId;\r\n    this.userId = userId;\r\n    this.currentTime = currentTime;\r\n  }\r\n}\r\n","export class MovieRoomRequest {\r\n\r\n  public movieId: string;\r\n  public userId: string;\r\n\r\n  constructor(movieId: string, userId: string) {\r\n    this.movieId = movieId;\r\n    this.userId = userId;\r\n  }\r\n}\r\n","export class MovieRoomSeekRequest {\r\n\r\n  public roomId: string;\r\n  public userId: string;\r\n  public currentTime: number;\r\n\r\n  constructor(roomId: string, userId: string, currentTime: number) {\r\n    this.roomId = roomId;\r\n    this.userId = userId;\r\n    this.currentTime = currentTime;\r\n  }\r\n}\r\n","export class MovieRoomWithIdRequest {\r\n\r\n  public roomId: string;\r\n  public userId: string;\r\n\r\n  constructor(roomId: string, userId: string) {\r\n    this.roomId = roomId;\r\n    this.userId = userId;\r\n  }\r\n}\r\n","export class MovieRoomsRequest {\r\n\r\n  public userId: string;\r\n\r\n  constructor(userId: string) {\r\n    this.userId = userId;\r\n  }\r\n}","import { SocialUser } from 'angularx-social-login';\r\n\r\nexport class SaveUserRequest {\r\n  \r\n  public user: SocialUser;\r\n\r\n  constructor(user: SocialUser) {\r\n    this.user = user;\r\n  }\r\n}\r\n","import { ChatMessage } from '../chatMessage';\r\n\r\nexport class SendChatMessageRequest {\r\n\r\n  public roomId: string;\r\n  public userId: string;\r\n  public chatMessage: ChatMessage;\r\n\r\n  constructor(roomId: string, userId: string, chatMessage: ChatMessage) {\r\n    this.roomId = roomId;\r\n    this.userId = userId;\r\n    this.chatMessage = chatMessage;\r\n  }\r\n}\r\n","import { MovieComment } from '../movieComment';\r\n\r\nexport class SendMovieCommentRequest {\r\n\r\n  public movieId: string;\r\n  public movieComment: MovieComment;\r\n\r\n  constructor(movieId: string, movieComment: MovieComment) {\r\n    this.movieId = movieId;\r\n    this.movieComment = movieComment;\r\n  }\r\n}\r\n","import { Injectable, OnInit } from '@angular/core';\nimport { CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot, UrlTree, Router } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { AuthService, SocialUser, GoogleLoginProvider } from 'angularx-social-login';\nimport { CookieService } from 'ngx-cookie-service';\nimport { WebSocketsService } from '../services/websocket.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuthGuard implements CanActivate {\n  user: SocialUser;\n  loggedIn: boolean;\n\n  constructor(\n    private authService: AuthService,\n    private cookieService: CookieService,\n    private webSocketService: WebSocketsService,\n    private router: Router) {\n\n    this.authService.authState.subscribe((user) => {\n      this.user = user;\n      this.loggedIn = (user != null);\n\n      if(this.loggedIn){\n        console.log(this.user);\n\n        webSocketService.sendSaveUserRequest(user);\n\n        this.saveToCookie(\"authToken\", this.user.authToken);\n        this.saveToCookie(\"idToken\", this.user.idToken);\n      }\n    });\n  }\n\n  canActivate(\n    next: ActivatedRouteSnapshot,\n    state: RouterStateSnapshot): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\n    let existentCookie = this.cookieService.get(\"authToken\");\n    if (!existentCookie) {\n      this.signInWithGoogle();\n    } else {\n      // this.router.navigate([\"movies\"]);\n      return true;\n    }\n  }\n\n  /**\n   * Checks if the given value is valid, in which case it saves it to cookies under the given name.\n   * @param name name of the cookie\n   * @param value\n   */\n  private saveToCookie(name: string, value: string) {\n    if (!value || value === \"invalid\") {\n      return;\n    }\n\n    let existentCookie = this.cookieService.get(name);\n    if (existentCookie === value) {\n      return;\n    }\n\n    this.cookieService.set(name, value, 1, \"/\");\n  }\n\n  signInWithGoogle(): Promise<void> {\n    return this.authService.signIn(GoogleLoginProvider.PROVIDER_ID, { ux_mode: \"redirect\" }).then((user) => {\n      if (user !== null && user.authToken) {\n        this.router.navigateByUrl('/', { skipLocationChange: true }).then(() =>\n          this.router.navigate([\"\"]));\n      }\n    });\n  }\n}\n","import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class AppConfigService {\r\n\r\n  private appConfig: any;\r\n\r\n  constructor() { }\r\n\r\n  // public loadAppConfig(): Promise<string | void> {\r\n  //   // return this.httpClient.get('/assets/config.json')\r\n  //   //   .toPromise()\r\n  //   //   .then(data => {\r\n  //   //     this.appConfig = data;\r\n  //   // });\r\n  // }\r\n\r\n  public get webSocketsServerUrl(): string {\r\n    // if (!this.appConfig) {\r\n    //   throw Error('Config file not loaded!');\r\n    // }\r\n\r\n\r\n    // return \"ws://echo.websocket.org\";\r\n    return \"wss://localhost:44343/movies\";\r\n  }\r\n}\r\n","import { Injectable, OnInit } from '@angular/core';\nimport { Observer, Subject } from 'rxjs';\n\nimport { AppConfigService } from './appConfig.service';\nimport { MessageWrapper } from '../entities/messageWrapper';\nimport { MessageType } from '../entities/messageType';\nimport { Movie } from '../entities/movie';\nimport { MovieListRequest } from '../entities/requests/movieListRequest';\nimport { AuthService, SocialUser } from 'angularx-social-login';\nimport { MovieRoomRequest } from '../entities/requests/movieRoomRequest';\nimport { MovieRoom } from '../entities/movieRoom';\nimport { MovieRoomsRequest } from '../entities/requests/movieRoomsRequest';\nimport { SaveUserRequest } from '../entities/requests/saveUserRequest';\nimport { MovieRoomWithIdRequest } from '../entities/requests/movieRoomWithIdRequest';\nimport { MovieRoomPauseRequest } from '../entities/requests/movieRoomPauseRequest';\nimport { MovieRoomPlayRequest } from '../entities/requests/movieRoomPlayRequest';\nimport { MovieRoomSeekRequest } from '../entities/requests/movieRoomSeekRequest';\nimport { MovieRoomAction } from '../entities/movieRoomAction';\nimport { ChatMessage } from '../entities/chatMessage';\nimport { SendChatMessageRequest } from '../entities/requests/sendChatMessageRequest';\nimport { ChatMessagesRequest } from '../entities/requests/chatMessagesRequest';\nimport { MovieComment } from '../entities/movieComment';\nimport { MovieCommentsRequest } from '../entities/requests/movieCommentsRequest';\nimport { SendMovieCommentRequest } from '../entities/requests/sendMovieCommentRequest';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WebSocketsService {\n  private user: SocialUser;\n  private webSocket: WebSocket;\n\n  // Maybe we only need one balance subject\n  private movieListResponseSubject: Subject<Movie[]>;\n  private movieListUpdateSubject: Subject<Movie[]>;\n\n  private movieRoomsResponseSubject: Subject<MovieRoom[]>;\n  private movieRoomsUpdateSubject: Subject<MovieRoom[]>;\n\n  private movieRoomResponseSubject: Subject<MovieRoom>;\n  private movieRoomUpdateSubject: Subject<MovieRoom>;\n\n  private movieRoomPauseUpdateSubject: Subject<MovieRoom>;\n  private movieRoomPlayUpdateSubject: Subject<MovieRoom>;\n  private movieRoomSeekUpdateSubject: Subject<MovieRoom>;\n\n  private chatMessagesReponseSubject: Subject<ChatMessage[]>;\n  private chatMessageUpdateSubject: Subject<ChatMessage>;\n\n  private commentsReponseSubject: Subject<MovieComment[]>;\n  private commentUpdateSubject: Subject<MovieComment>;\n\n  constructor(private appConfigService: AppConfigService, private authService: AuthService) {\n    this.authService.authState.subscribe((user) => {\n      if (user !== null && user !== undefined) {\n        this.user = user;\n        console.log(this.user);\n      }\n    });\n\n    this.movieListResponseSubject = new Subject<Movie[]>();\n    this.movieListUpdateSubject = new Subject<Movie[]>();\n\n    this.movieRoomsResponseSubject = new Subject<MovieRoom[]>();\n    this.movieRoomsUpdateSubject = new Subject<MovieRoom[]>();\n\n    this.movieRoomResponseSubject = new Subject<MovieRoom>();\n    this.movieRoomUpdateSubject = new Subject<MovieRoom>();\n\n    this.movieRoomPauseUpdateSubject = new Subject<MovieRoom>();\n    this.movieRoomPlayUpdateSubject = new Subject<MovieRoom>();\n    this.movieRoomSeekUpdateSubject = new Subject<MovieRoom>();\n\n    this.chatMessagesReponseSubject = new Subject<ChatMessage[]>();\n    this.chatMessageUpdateSubject = new Subject<ChatMessage>();\n\n    this.commentsReponseSubject = new Subject<MovieComment[]>();\n    this.commentUpdateSubject = new Subject<MovieComment>();\n  }\n\n  public start(): void {\n    console.debug('Going to connect to the websockets server');\n    this.connect(this.appConfigService.webSocketsServerUrl);\n  }\n\n  public stop(): void {\n    if (this.webSocket != null) {\n      this.webSocket.close();\n    }\n  }\n\n  public subscribeToMovieListResponses(observer: Observer<Movie[]>): void {\n    this.movieListResponseSubject.subscribe(observer);\n  }\n\n  public subscribeToMovieListUpdates(observer: Observer<Movie[]>): void {\n    this.movieListUpdateSubject.subscribe(observer);\n  }\n\n  public subscribeToMovieRoomsResponses(observer: Observer<MovieRoom[]>): void {\n    this.movieRoomsResponseSubject.subscribe(observer);\n  }\n\n  public subscribeToMovieRoomsUpdates(observer: Observer<MovieRoom[]>): void {\n    this.movieRoomsUpdateSubject.subscribe(observer);\n  }\n\n  public subscribeToMovieRoomResponses(observer: Observer<MovieRoom>): void {\n    this.movieRoomResponseSubject.subscribe(observer);\n  }\n\n  public subscribeToMovieRoomUpdates(observer: Observer<MovieRoom>): void {\n    this.movieRoomUpdateSubject.subscribe(observer);\n  }\n\n  public subscribeToMovieRoomPauseUpdates(observer: Observer<MovieRoom>): void {\n    this.movieRoomPauseUpdateSubject.subscribe(observer);\n  }\n\n  public subscribeToMovieRoomPlayUpdates(observer: Observer<MovieRoom>): void {\n    this.movieRoomPlayUpdateSubject.subscribe(observer);\n  }\n\n  public subscribeToMovieRoomSeekUpdates(observer: Observer<MovieRoom>): void {\n    this.movieRoomSeekUpdateSubject.subscribe(observer);\n  }\n\n  public subscribeToChatMessagesReponses(observer: Observer<ChatMessage[]>): void {\n    this.chatMessagesReponseSubject.subscribe(observer);\n  }\n\n  public subscribeToChatMessageUpdates(observer: Observer<ChatMessage>): void {\n    this.chatMessageUpdateSubject.subscribe(observer);\n  }\n\n  public subscribeToMovieCommentsReponses(observer: Observer<MovieComment[]>): void {\n    this.commentsReponseSubject.subscribe(observer);\n  }\n\n  public subscribeToMovieCommentUpdates(observer: Observer<MovieComment>): void {\n    this.commentUpdateSubject.subscribe(observer);\n  }\n\n  private connect(url: string): void {\n    this.webSocket = new WebSocket(url);\n\n    this.webSocket.onopen = function (messageEvent: MessageEvent) {\n      console.info('WebSocket connection has been opened: %o', messageEvent);\n    };\n\n    // we need the \"self\" constant because we cannot use \"this\" inside the function below\n    const self = this;\n\n    this.webSocket.onmessage = function (messageEvent: MessageEvent) {\n      const jsonReceived: string = messageEvent.data;\n\n      console.debug('WebSocket message received: %s', jsonReceived);\n\n      self.authService.authState.subscribe((user) => {\n        if (user !== undefined && user !== null) {\n          self.user = user;\n          self.handleMessage(jsonReceived);\n        }\n      })\n\n    };;\n\n    this.webSocket.onerror = function (messageEvent: MessageEvent) {\n      console.error('WebSocket error observed: %o', messageEvent);\n    };\n\n    this.webSocket.onclose = function (closeEvent: CloseEvent) {\n      console.info('WebSocket connection has been closed: %o', closeEvent);\n    };\n  }\n\n  public sendSaveUserRequest(user: SocialUser): void {\n    const request: SaveUserRequest = new SaveUserRequest(user);\n    const message: MessageWrapper = new MessageWrapper(MessageType.SAVE_USER_REQUEST, request);\n\n    this.sendMessage(this.webSocket, message);\n  }\n\n  public sendMovieListRequest(): void {\n    const request: MovieListRequest = new MovieListRequest();\n    const message: MessageWrapper = new MessageWrapper(MessageType.MOVIE_LIST_REQUEST, request);\n\n    this.sendMessage(this.webSocket, message);\n  }\n\n  public sendMovieStreamRequest(): void {\n    const request: MovieListRequest = new MovieListRequest();\n    const message: MessageWrapper = new MessageWrapper(MessageType.MOVIE_LIST_REQUEST, request);\n\n    this.sendMessage(this.webSocket, message);\n  }\n\n  public sendMovieRoomsRequest(): void {\n    this.authService.authState.subscribe(user => {\n      const request: MovieRoomsRequest = new MovieRoomsRequest(user.id);\n      const message: MessageWrapper = new MessageWrapper(MessageType.MOVIE_ROOMS_REQUEST, request);\n\n      this.sendMessage(this.webSocket, message);\n    });\n  }\n\n  public sendMovieRoomRequest(movieId: string): void {\n    this.authService.authState.subscribe(user => {\n      const request: MovieRoomRequest = new MovieRoomRequest(movieId, user.id);\n      const message: MessageWrapper = new MessageWrapper(MessageType.MOVIE_ROOM_REQUEST, request);\n\n      this.sendMessage(this.webSocket, message);\n    });\n  }\n\n  public sendMovieRoomWithIdRequest(roomId: string): void {\n    this.authService.authState.subscribe(user => {\n      const request: MovieRoomWithIdRequest = new MovieRoomWithIdRequest(roomId, user.id);\n      const message: MessageWrapper = new MessageWrapper(MessageType.MOVIE_ROOM_WITH_ID_REQUEST, request);\n\n      this.sendMessage(this.webSocket, message);\n    });\n  }\n\n  public sendPauseRequest(roomId: string, currentTime: number): void {\n    this.authService.authState.subscribe(user => {\n      const request: MovieRoomPauseRequest = new MovieRoomPauseRequest(roomId, user.id, currentTime);\n      const message: MessageWrapper = new MessageWrapper(MessageType.MOVIE_ROOM_PAUSE_REQUEST, request);\n\n      this.sendMessage(this.webSocket, message);\n    });\n  }\n\n  public sendPlayRequest(roomId: string, currentTime: number): void {\n    this.authService.authState.subscribe(user => {\n      const request: MovieRoomPlayRequest = new MovieRoomPlayRequest(roomId, user.id, currentTime);\n      const message: MessageWrapper = new MessageWrapper(MessageType.MOVIE_ROOM_PLAY_REQUEST, request);\n\n      this.sendMessage(this.webSocket, message);\n    });\n  }\n\n  public sendSeekRequest(roomId: string, currentTime: number): void {\n    this.authService.authState.subscribe(user => {\n      const request: MovieRoomSeekRequest = new MovieRoomSeekRequest(roomId, user.id, currentTime);\n      const message: MessageWrapper = new MessageWrapper(MessageType.MOVIE_ROOM_SEEK_REQUEST, request);\n\n      this.sendMessage(this.webSocket, message);\n    });\n  }\n\n  public sendChatMessagesRequest(roomId: string): void {\n    this.authService.authState.subscribe(user => {\n      const request: ChatMessagesRequest = new ChatMessagesRequest(roomId, user.id);\n      const message: MessageWrapper = new MessageWrapper(MessageType.CHAT_MESSAGES_REQUEST, request);\n\n      this.sendMessage(this.webSocket, message);\n    });\n  }\n\n  public sendChatMessageRequest(roomId: string, chatMessage: ChatMessage): void {\n    this.authService.authState.subscribe(user => {\n      if (user) {\n        chatMessage.User = user\n        const request: SendChatMessageRequest = new SendChatMessageRequest(roomId, user.id, chatMessage);\n        const message: MessageWrapper = new MessageWrapper(MessageType.SEND_CHAT_MESSAGE_REQUEST, request);\n\n        this.sendMessage(this.webSocket, message);\n      }\n    });\n  }\n\n  public sendMovieCommentsRequest(movieId: string): void {\n    const request: MovieCommentsRequest = new MovieCommentsRequest(movieId);\n    const message: MessageWrapper = new MessageWrapper(MessageType.MOVIE_COMMENTS_REQUEST, request);\n\n    this.sendMessage(this.webSocket, message);\n  }\n\n  public sendMovieCommentRequest(movieId: string, comment: MovieComment): void {\n    this.authService.authState.subscribe(user => {\n      if (user) {\n        const request: SendMovieCommentRequest = new SendMovieCommentRequest(movieId, comment);\n        const message: MessageWrapper = new MessageWrapper(MessageType.SEND_MOVIE_COMMENT_REQUEST, request);\n\n        this.sendMessage(this.webSocket, message);\n      }\n    });\n  }\n\n  private waitForOpenConnection(socket: WebSocket) {\n    return new Promise((resolve, reject) => {\n      const maxNumberOfAttempts = 10\n      const intervalTime = 200 //ms\n\n      let currentAttempt = 0\n      const interval = setInterval(() => {\n        if (currentAttempt > maxNumberOfAttempts - 1) {\n          clearInterval(interval)\n          reject(new Error('Maximum number of attempts exceeded'))\n        } else if (socket.readyState === socket.OPEN) {\n          clearInterval(interval)\n          resolve()\n        }\n        currentAttempt++\n      }, intervalTime)\n    })\n  }\n\n  private async sendMessage(socket: WebSocket, message: MessageWrapper) {\n    if (socket.readyState !== socket.OPEN) {\n      try {\n        await this.waitForOpenConnection(socket);\n      } catch (err) {\n        console.error(err)\n        return;\n      }\n    }\n\n    socket.send(JSON.stringify(message))\n  }\n\n  private handleMessage(messageRecieved: string) {\n    let messageWrapper = this.validateAndGetMessage(messageRecieved);\n\n    switch (messageWrapper.type) {\n      case MessageType.MOVIE_LIST_RESPONSE:\n        let movies: Movie[] = [];\n        try {\n          movies = JSON.parse(messageWrapper.payload);\n        } catch (error) {\n          console.error('Movie list reponse: Unable to deserialize Movie[] object: %s',\n            messageWrapper.payload);\n          return;\n        }\n\n        console.debug('Movies message received: %o', movies);\n        this.movieListResponseSubject.next(movies);\n        break;\n      case MessageType.MOVIE_ROOMS_RESPONSE:\n        let rooms: MovieRoom[];\n        try {\n          rooms = JSON.parse(messageWrapper.payload);\n        } catch (error) {\n          console.error('Room reponse: Unable to deserialize MovieRoom object: %s',\n            messageWrapper.payload);\n          return;\n        }\n\n        console.debug('Room received: %o', rooms);\n        this.movieRoomsResponseSubject.next(rooms);\n        break;\n\n      case MessageType.MOVIE_ROOMS_UPDATE:\n        let roomsUpdated: MovieRoom[];\n        try {\n          roomsUpdated = JSON.parse(messageWrapper.payload);\n        } catch (error) {\n          console.error('Room reponse: Unable to deserialize MovieRoom object: %s',\n            messageWrapper.payload);\n          return;\n        }\n\n        console.debug('Room received: %o', roomsUpdated);\n        this.movieRoomsUpdateSubject.next(roomsUpdated);\n        break;\n\n\n      case MessageType.MOVIE_ROOM_RESPONSE:\n        let room: MovieRoom;\n        try {\n          room = JSON.parse(messageWrapper.payload);\n        } catch (error) {\n          console.error('Room reponse: Unable to deserialize MovieRoom object: %s',\n            messageWrapper.payload);\n          return;\n        }\n\n        console.debug('Room received: %o', room);\n        this.movieRoomResponseSubject.next(room);\n        break;\n\n      case MessageType.MOVIE_ROOM_UPDATE:\n        let roomUpdated: MovieRoom;\n        try {\n          roomUpdated = JSON.parse(messageWrapper.payload);\n        } catch (error) {\n          console.error('Room update: Unable to deserialize MovieRoom object: %s',\n            messageWrapper.payload);\n          return;\n        }\n\n        console.debug('Room received: %o', roomUpdated);\n        this.movieRoomUpdateSubject.next(roomUpdated);\n        break;\n\n      case MessageType.MOVIE_ROOM_PLAY_UPDATE:\n        let roomActionPlay: MovieRoomAction;\n        try {\n          roomActionPlay = JSON.parse(messageWrapper.payload);\n        } catch (error) {\n          console.error('Play video: Unable to deserialize MovieRoomAction object: %s',\n            messageWrapper.payload);\n          return;\n        }\n\n        if (roomActionPlay.UserId === this.user.id) {\n          return;\n        }\n\n        console.debug('Room received: %o', roomActionPlay.Room);\n        this.movieRoomPlayUpdateSubject.next(roomActionPlay.Room);\n        break;\n\n      case MessageType.MOVIE_ROOM_PAUSE_UPDATE:\n        let roomActionPause: MovieRoomAction;\n        try {\n          roomActionPause = JSON.parse(messageWrapper.payload);\n        } catch (error) {\n          console.error('Pause video: Unable to deserialize MovieRoomAction object: %s',\n            messageWrapper.payload);\n          return;\n        }\n\n        if (roomActionPause.UserId === this.user.id) {\n          return;\n        }\n\n        console.debug('Room received: %o', roomActionPause.Room);\n        this.movieRoomPauseUpdateSubject.next(roomActionPause.Room);\n        break;\n\n      case MessageType.MOVIE_ROOM_SEEK_UPDATE:\n        let roomActionSeek: MovieRoomAction;\n        try {\n          roomActionSeek = JSON.parse(messageWrapper.payload);\n        } catch (error) {\n          console.error('Seek video: Unable to deserialize MovieRoomAction object: %s',\n            messageWrapper.payload);\n          return;\n        }\n\n        if (roomActionSeek.UserId === this.user.id) {\n          return;\n        }\n\n        console.debug('Room received: %o', roomActionSeek.Room);\n        this.movieRoomSeekUpdateSubject.next(roomActionSeek.Room);\n        break;\n\n      case MessageType.CHAT_MESSAGES_RESPONSE:\n        let messages: ChatMessage[];\n        try {\n          messages = JSON.parse(messageWrapper.payload);\n        } catch (error) {\n          console.error('Get chat messages response: Unable to deserialize ChatMessage[] object: %s',\n            messageWrapper.payload);\n          return;\n        }\n\n        console.debug('Chat Message received: %o', messages);\n        this.chatMessagesReponseSubject.next(messages);\n        break;\n\n      case MessageType.CHAT_MESSAGE_UPDATE:\n        let message: ChatMessage;\n        try {\n          message = JSON.parse(messageWrapper.payload);\n        } catch (error) {\n          console.error('Get chat message rupdate : Unable to deserialize ChatMessage object: %s',\n            messageWrapper.payload);\n          return;\n        }\n\n        if (message.User.id === this.user.id) {\n          // if the message was sent by the current user, exit\n          return;\n        }\n\n        console.debug('Chat Message received: %o', message);\n        this.chatMessageUpdateSubject.next(message);\n        break;\n\n        case MessageType.MOVIE_COMMENTS_RESPONSE:\n          let comments: MovieComment[];\n          try {\n            comments = JSON.parse(messageWrapper.payload);\n          } catch (error) {\n            console.error('Get movie comments response: Unable to deserialize MovieComment[] object: %s',\n              messageWrapper.payload);\n            return;\n          }\n  \n          console.debug('Movie comments received: %o', comments);\n          this.commentsReponseSubject.next(comments);\n          break;\n  \n        case MessageType.MOVIE_COMMENT_UPDATE:\n          let comment: MovieComment;\n          try {\n            comment = JSON.parse(messageWrapper.payload);\n          } catch (error) {\n            console.error('Get movie comment update : Unable to deserialize MovieComment object: %s',\n              messageWrapper.payload);\n            return;\n          }\n  \n          if (comment.User.id === this.user.id) {\n            // if the message was sent by the current user, exit\n            return;\n          }\n  \n          console.debug('Chat Message received: %o', comment);\n          this.commentUpdateSubject.next(comment);\n          break;\n\n      default: break;\n    }\n  }\n\n  private validateAndGetMessage(messageReceived: string) {\n    let messageWrapper: MessageWrapper;\n    try {\n      messageWrapper = JSON.parse(messageReceived);\n    } catch (error) {\n      console.error('Unable to parse received JSON string: %s\\n%o',\n        messageReceived, error);\n      return;\n    }\n\n    if (!messageWrapper.hasOwnProperty('type') ||\n      !messageWrapper.hasOwnProperty('payload')) {\n      console.error('Invalid message received, not the correct properties: %s',\n        messageReceived);\n      return;\n    }\n\n    return messageWrapper;\n  }\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"]}